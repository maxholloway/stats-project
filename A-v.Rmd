## Initialize data

```{r warning=FALSE}
if (!file.exists("2010_sqf_m35.csv")) {
  download.file("http://math.hmc.edu/m35f/2010_sqf_m35.csv", "2010_sqf_m35.csv")
}
if (!file.exists("2015_sqf_m35.csv")) {
  download.file("http://math.hmc.edu/m35f/2015_sqf_m35.csv", "2015_sqf_m35.csv")
}
sqf2010 <- read.csv("2010_sqf_m35.csv")
sqf2015 <- read.csv("2015_sqf_m35.csv")

sqf2015 = sqf2015[!sqf2015$perstop=="**"
                  & !sqf2015$perstop==" ",]
sqf2015$perstop = as.numeric(as.character(sqf2015$perstop))

sqf2010 <- subset(sqf2010, sqf2010$weight > 50 & sqf2010$weight < 400)
sqf2010 <- subset(sqf2010, sqf2010$age < 100)
```

## Hypothesis Tests for Proportions part A
We will perform a hypothesis test for the proportions being equal, by testing $H_0: p = p_0$ and $H_1: p > p_0$ with a significance level of $\alpha=0.05$. 
```{r eval=TRUE}
n <- length(sqf2015$frisked)
p <- sum(sqf2015$frisked) / n # sample proportion of people frisked
po <- 0.675 # proposed population proportion of people frisked 

z_test <- (p - po)/(sqrt(p*(1-p)/n)) # calculate test statistic
print(z_test)

z_critical <- 1.645 # critical value for 95% confidence of p > po

reject_H0 <- z_test > z_critical
print(reject_H0)
```
Because the test statistic is less than the critical value, we fail to reject the null hypothesis. Hence we cannot conclude with 95% confidence that the population proportion of people being frisked is greater than 0.675.

## Hypothesis Tests for Proportions part B
We will perform a t test to determine if the people who refused to show ID were frisked the same amount as people who did not refuse to show ID.

```{r eval=TRUE}
sqf2015friskednoid = sqf2015$frisked[sqf2015$typeofid=="REFUSED"]
sqf2015friskedid = sqf2015$frisked[sqf2015$typeofid!="REFUSED"]
t.test(x=sqf2015friskedid,
       y=sqf2015friskednoid,
       alternative = "two.sided",
       mu=0, paired = FALSE,
       var.equal = TRUE,
       conf.level = 0.95)
```
With a tval of -3.5781 and 22500 degrees of freedom, we generate a 95 percent confidence interval for the differenc of means: $0.03039181 < \mu_1-\mu_2 < 0.10402569$. Because the confidence interval does not include 0, we conclude with 95% confidence that the two means are not the same. Additionally, the p-value associated with this t value and degrees of freedom is 0.0003469, which is less that 0.05. Hence, we reject $H_0$ that claims the two means are the same.
